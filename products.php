<?php
include_once 'include/session-db-func.php';
include_once 'include/header.php';	
?>


        <div class="header-empty-space"></div>

        <div class="container">
            <div class="empty-space col-xs-b15 col-sm-b30"></div>
            
            <div class="row">
                <div class="col-md-9 col-md-push-3">
                    <div class="slider-wrapper">
                        <div class="swiper-container arrows-align-top" data-breakpoints="1" data-xs-slides="1" data-sm-slides="3" data-md-slides="4" data-lt-slides="4" data-slides-per-view="4">
                            <div class="h4 swiper-title">popular products</div>
                            <div class="swiper-button-prev style-1"></div>
                            <div class="swiper-button-next style-1"></div>
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                    <div class="product-shortcode style-1 small">
                                        <div class="title">
                                            <div class="simple-article size-1 color col-xs-b5"><a href="#">GAMING LAPTOP</a></div>
                                            <div class="h6 animate-to-green"><a href="/fyp-project/product.php?product=10023">Acer Nitro 5</a></div>
                                        </div>
                                        <div class="preview">
                                            <img src="/fyp-project/product_img/AcerNitro5_01.png" alt="">
                                            <div class="preview-buttons valign-middle">
                                                <div class="valign-middle-content">
                                                    <a class="button size-2 style-2" href="/fyp-project/product.php?product=10023">
                                                        <span class="button-wrapper">
                                                            <span class="icon"><img src="img/icon-1.png" alt=""></span>
                                                            <span class="text">Learn More</span>
                                                        </span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="price">
                                            <div class="simple-article size-4 dark">RM4,149.00</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide">
                                    <div class="product-shortcode style-1 small">
                                        <div class="title">
                                            <div class="simple-article size-1 color col-xs-b5"><a href="#">GAMING LAPTOP</a></div>
                                            <div class="h6 animate-to-green"><a href="/fyp-project/product.php?product=10022">Asus TUF Dash F15</a></div>
                                        </div>
                                        <div class="preview">
                                            <img src="/fyp-project/product_img/AsusTUFDash01.png" alt="">
                                            <div class="preview-buttons valign-middle">
                                                <div class="valign-middle-content">
                                                    <a class="button size-2 style-2" href="/fyp-project/product.php?product=10022">
                                                        <span class="button-wrapper">
                                                            <span class="icon"><img src="img/icon-1.png" alt=""></span>
                                                            <span class="text">Learn More</span>
                                                        </span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="price">
                                            <div class="simple-article size-4 dark">RM4,799.00</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide">
                                    <div class="product-shortcode style-1 small">
                                        <div class="title">
                                            <div class="simple-article size-1 color col-xs-b5"><a href="#">GAMING HEADSET</a></div>
                                            <div class="h6 animate-to-green"><a href="/fyp-project/product.php?product=10003">Razer Kraken Bluetooth Kitty Edition Wireless Gaming RGB Headset</a></div>
                                        </div>
                                        <div class="preview">
                                            <img src="/fyp-project/product_img/RazerKrakenBluetoothKitty_GH.png" alt="">
                                            <div class="preview-buttons valign-middle">
                                                <div class="valign-middle-content">
                                                    <a class="button size-2 style-2" href="/fyp-project/product.php?product=10003">
                                                        <span class="button-wrapper">
                                                            <span class="icon"><img src="img/icon-1.png" alt=""></span>
                                                            <span class="text">Learn More</span>
                                                        </span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="price">
                                            <div class="simple-article size-4 dark">RM410.90</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide">
                                    <div class="product-shortcode style-1 small">
                                        <div class="title">
                                            <div class="simple-article size-1 color col-xs-b5"><a href="#">GAMING KEYBOARD</a></div>
                                            <div class="h6 animate-to-green"><a href="/fyp-project/product.php?product=10006">Razer BlackWidow Green</a></div>
                                        </div>
                                        <div class="preview">
                                            <img src="/fyp-project/product_img/RazerBlackWidow_kb.png" alt="">
                                            <div class="preview-buttons valign-middle">
                                                <div class="valign-middle-content">
                                                    <a class="button size-2 style-2" href="/fyp-project/product.php?product=10006">
                                                        <span class="button-wrapper">
                                                            <span class="icon"><img src="img/icon-1.png" alt=""></span>
                                                            <span class="text">Learn More</span>
                                                        </span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="price">
                                            <div class="simple-article size-4 dark">RM361.90</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide">
                                    <div class="product-shortcode style-1 small">
                                        <div class="title">
                                            <div class="simple-article size-1 color col-xs-b5"><a href="#">GAMING MICE</a></div>
                                            <div class="h6 animate-to-green"><a href="/fyp-project/product.php?product=10008">Razer DeathAdder</a></div>
                                        </div>
                                        <div class="preview">
                                            <img src="/fyp-project/product_img/RazerDeathAdderWired_gm.png" alt="">
                                            <div class="preview-buttons valign-middle">
                                                <div class="valign-middle-content">
                                                    <a class="button size-2 style-2" href="/fyp-project/product.php?product=10008">
                                                        <span class="button-wrapper">
                                                            <span class="icon"><img src="img/icon-1.png" alt=""></span>
                                                            <span class="text">Learn More</span>
                                                        </span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="price">
                                            <div class="simple-article size-4 dark">RM96.90</div>
                                        </div>
                                    </div>
                                </div>
                             </div>
                            <div class="swiper-pagination relative-pagination visible-xs"></div>
                        </div>
                    </div>

                    <div class="empty-space col-xs-b20 col-sm-b35 col-md-b70"></div>

             
                    <div class="align-inline spacing-1">
                        <div class="h4">ALL PRODUCTS</div>
                    </div>
                    
	<!--------------------------------------------------------------------------------->     
                    <div class="align-inline spacing-1 hidden-xs">
                        <a class="pagination toggle-products-view active"><img src="img/icon-14.png" alt="" /><img src="img/icon-15.png" alt="" /></a>
                        <a class="pagination toggle-products-view"><img src="img/icon-16.png" alt="" /><img src="img/icon-17.png" alt="" /></a>
                    </div>
	<!--------------------------------------------------------------------------------->  
           

	<!--------------------------------------------------------------------------------->     
                    <div class="products-content">
                        <div class="products-wrapper">
                            <div class="row nopadding">

<!------------------------------------------------------------------------------->
<?php  
            
                        
                        include_once 'include/dbh-inc.php';
							$sql = "SELECT * FROM product WHERE product_availability = 'YES'";
							$result = $conn->query($sql);
							
								while($data = mysqli_fetch_array($result))
								{
                                    $bigSwiperImgs = explode(" ", $data['product_bigSwiperImg']);
									$d=$data['product_id'];
									echo "<div class='col-sm-4'>
                                            <div class='product-shortcode style-1'>
                                                <div class='title'>
                                                    <div class='simple-article size-1 color col-xs-b5'>";
                                    echo  "<a href = '/fyp-project/product.php?product=$d'vertical-align: text-top;>".$data['product_category0'] . " ". $data['product_category1']."</a>" ;
	
									echo "</div><div class='h6 animate-to-green'><a href = '/fyp-project/product.php?product=$d'>" . $data['product_name'] . "</div>
                                    </div>";
									
                                        echo "<div class='preview'><img src='./admin/product_img/". $bigSwiperImgs[0] . "' width='200' height='200'/></td>";
                                 
									echo "<div class='preview-buttons valign-middle'>
                                    <div class='valign-middle-content'>
                                        <a class='button size-2 style-2' href='/fyp-project/product.php?product=$d'>
                                            <span class='button-wrapper'>
                                                <span class='icon'><img src='img/icon-1.png'></span>
                                                <span class='text'>Learn More</span>
                                            </span>
                                        </a>
                                    </div>
                                             </div>
                                    </div><div class='price'>
                                    <div class='simple-article size-4 dark'>RM ". $data['product_regularPrice'] ."</div>
                                </div>
                            </div>  
                                </div>"  ;
					                        }
?>
                            
<!----------------------------------------------------------------------------------------------->

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-md-pull-9">
						<div class="row">
							<div class="h4 col-xs-b10">popular categories</div>
							<ul class="categories-menu transparent">
								<?php
								$sql = "
								SELECT category_name FROM category
								";
								$stmt = mysqli_stmt_init($conn);
								if(!mysqli_stmt_prepare($stmt, $sql)){
									//header("location: cart.php?error=stmtfailed");
									//echo "<script type='text/javascript'>alert('stmt failed!');</script>";
									//exit();
									mysqli_close($conn);
								}
								else
								{
									//echo "<script type='text/javascript'>alert('stmt successful!');</script>";
								}
								mysqli_stmt_execute($stmt);
								$categories = mysqli_stmt_get_result($stmt);
								$categoriesArray = array();
								while ($categoriesRow = mysqli_fetch_assoc($categories))
								{
								  $categoriesArray[] = $categoriesRow;
								}

								$sql = "
								SELECT subcategory_name FROM subcategory
								";
								$stmt = mysqli_stmt_init($conn);
								if(!mysqli_stmt_prepare($stmt, $sql)){
									//header("location: cart.php?error=stmtfailed");
									//echo "<script type='text/javascript'>alert('stmt failed!');</script>";
									//exit();
									mysqli_close($conn);
								}
								else
								{
									//echo "<script type='text/javascript'>alert('stmt successful!');</script>";
								}
								mysqli_stmt_execute($stmt);
								$subcategories = mysqli_stmt_get_result($stmt);

								$subcategoriesArray = array();
								while ($subcategoriesRow = mysqli_fetch_assoc($subcategories))
								{
								  $subcategoriesArray[] = $subcategoriesRow;
								}
								
								
								for($i = 0 ; $i< count($categoriesArray) ; $i++)
								{
									$categoryName = $categoriesArray[$i]['category_name'];
									echo "
										<li>
											<a>". $categoryName ."</a>
											<div class='toggle'></div>
											<ul>
											";
											for($j = 0 ; $j< count($subcategoriesArray) ; $j++)
											{
												$subcategoryName = $subcategoriesArray[$j]['subcategory_name'];
												echo "
													<li>
														<a>". $categoryName." ".$subcategoryName ."</a>
														<div class='toggle'></div>
														<ul>";
														
														settype($categoryName, "string");
														settype($subcategoryName, "string");
														$sql = "
														SELECT product_id, product_name FROM product 
														WHERE product_category0 = '$categoryName'
														AND product_category1 = '$subcategoryName'
														";
														
														$stmt = mysqli_stmt_init($conn);
														if(!mysqli_stmt_prepare($stmt, $sql)){
															mysqli_close($conn);
														}
														else
														{
															//echo "<script type='text/javascript'>alert('stmt successful!');</script>";
														}
														mysqli_stmt_execute($stmt);
														$productsByCategories = mysqli_stmt_get_result($stmt);
														$productsByCategoriesRow = mysqli_fetch_assoc($productsByCategories);
														foreach($productsByCategories as $data)
														{
															//print_r($data['product_name']);
															echo "
																<li>
																	<a href='/fyp-project/product.php?product=".$data['product_id']."'>".$data['product_name']."</a>
																</li>
																";
														}
												echo "	</ul>
													</li>
													";
											}
									echo "
											</ul>
										</li>
										";
								}
								?>
							</ul>
							<div class="empty-space col-xs-b25 col-sm-b50"></div>
						</div> 
					</div>
				
			</div>
		</div>
<?php
include_once 'include/footer.php';
?>
<?php
include_once 'include/header_popup.php';
?>